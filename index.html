<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dessert Cost Calculator</title>

  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#f3dfe4">

  <!-- Cache-bust -->
  <link rel="stylesheet" href="style.css?v=20260208" />
</head>
<body>

<!-- Sidebar overlay + drawer -->
<div id="drawerOverlay" class="drawerOverlay" aria-hidden="true"></div>

<aside id="drawer" class="drawer" aria-label="Recipes">
  <div class="drawerHeader">
    <p class="drawerTitle">Recipes</p>
    <button id="closeDrawerBtn" class="iconBtn" type="button" aria-label="Close">✕</button>
  </div>

  <div class="drawerBody">
    <div class="drawerCard">
      <div class="drawerRow">
        <input id="newRecipeName" placeholder="New recipe name (e.g., Kuchen)" />
        <button id="createRecipeBtn" class="btn" type="button">Create</button>
      </div>
      <div class="smallNote">Tip: Open a recipe, then press <b>Save</b> to store its ingredients.</div>
    </div>

    <div class="drawerCard">
      <div class="drawerRow" style="justify-content:space-between; gap:10px;">
        <div class="pill">Current recipe</div>
        <button id="saveRecipeBtn" class="btn" type="button">Save</button>
      </div>
      <div id="recipeList" class="recipeList" role="list"></div>
    </div>
  </div>
</aside>

<header class="topbar">
  <div class="brand">
    <button id="openDrawerBtn" class="hamburger" type="button" aria-label="Open menu">☰</button>
    <div>
      <h1 id="recipeTitle">Dessert Cost Calculator</h1>
      <p class="sub">Ingredient → unit cost → recipe cost</p>
    </div>
  </div>
  <div class="actions">
    <button id="addRowBtn" class="btn" type="button">+ Add</button>
    <button id="resetBtn" class="btn btn-secondary" type="button">Reset</button>
  </div>
</header>

<main class="container">
  <section class="card">

    <div class="tableWrap">
      <table id="tbl">
        <colgroup>
          <col class="c-name">
          <col class="c-num">
          <col class="c-num">
          <col class="c-num">
          <col class="c-num">
          <col class="c-num">
          <col class="c-btn">
        </colgroup>

        <thead>
          <tr>
            <th>Ingredient</th>
            <th>Cost</th>
            <th>Amount</th>
            <th>Unit Cost</th>
            <th>Recipe Amount</th>
            <th>Recipe Cost</th>
            <th></th>
          </tr>
        </thead>

        <tbody id="tbody"></tbody>

        <tfoot>
          <tr>
            <td colspan="5" class="totalLabel">Total</td>
            <td class="totalValue" id="totalCell">$0</td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </div>

    <!-- Pricing / Margin -->
    <div class="pricing">
      <div class="drawerCard">
        <div class="kv">
          <div class="k">Profit margin (%)</div>
          <input id="marginPct" inputmode="decimal" value="30" style="max-width:120px;" />
        </div>
        <div class="smallNote">Final price is rounded to an integer.</div>
      </div>

      <div class="drawerCard">
        <div class="kv">
          <div class="k">Final sale price</div>
          <div class="v" id="finalPriceCell">$0</div>
        </div>
      </div>
    </div>

    <div class="hint">
      On iPhone: Safari → Share → Add to Home Screen.
    </div>

  </section>
</main>

<!-- Cache-bust -->
<script src="app.js?v=20260208"></script>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./service-worker.js', { updateViaCache: 'none' })
    .then(reg => { try { reg.update(); } catch(e) {} })
    .catch(()=>{});
}
</script>

</body>
</html>
